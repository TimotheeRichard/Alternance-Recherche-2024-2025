# I.2.a. Simulation pour la calibration

## 1. Détermination de la loi de distribution a priori

**Il faut commencer par déterminer les lois de distribution a priori de nos paramètres, afin de pouvoir par la suite utiliser ces lois dans la simulation des petites chaînes de Markov et des grandes chaînes de Markov**

**_Dans notre cas, on utilise cette distribution a priori :_**

| Paramètres | Loi de distribution a priori | par1 | par2 |
| ------ | ------ | ------ | ------ |
| **Tmig (j)** | Uniforme | 100 | 5000 |
| **%ero** | Uniforme | 0,5 | 10 |

## 2. Création des fichiers .in

**On utilise le script R ci_dessous pour créer les fichiers .in permettant de simuler trois chaînes de Markov à 200 itérations avec chacune un différent seed.**

```r
###############
###
### Ecriture des fichiers in
###
##########################################################
rm(list = ls()) #supprime tous les objets dans l'environnement de travail
setwd("C:/Users/richa/OneDrive/Desktop/Alternance recherche/Bayesien Informatique/mcsim_under_R/MCSim under R/Trajectory")
library(lubridate)
i = 3 # Numéro de la chaine
seed = 0
if(i == 1){
  seed = 1835128
}
if(i == 2){
  seed = 634128
}
if(i == 3){
  seed = 3412895
}
nb_iter = 200;

List_Catchment = c("Meuse","Loire","Moselle", "Rhin", "Rhone")#Catchment = bassin versant

Name_catchment = List_Catchment[3]

RepData = paste("C:/Users/richa/OneDrive/Desktop/Alternance recherche/Bayesien Informatique/mcsim_under_R/MCSim under R/Trajectory/",Name_catchment,"/Data",sep="")

RepIn = paste(Name_catchment,"/In/",sep="") #sep="" dit qu'on va coller les deux chaînes de caractères juste avant sans rien entre les deux

df_Parameters = read.table(file =paste(RepData,"/Parametres",Name_catchment,".csv",sep=""),sep=";",dec=",",header=TRUE) #lecture des paramètres
head(df_Parameters) #juste afficher pour voir si c'est bon je pense
names(df_Parameters) = c("n0","nsol","z0","zmax","ro","Tmig","lrn","pero","Dt","Kdd","d","Q","SS","d50","nsed") #Redéfinit les noms des colonnes pour éviter les unités et tout dans les noms

df_Depot = read.table(file =paste(RepData,"/Depots",Name_catchment,".csv",sep=""),sep=";",dec=",",header=TRUE) #Tout pareil avec les dépots
head(df_Depot)
names(df_Depot) = c("Annee","Date","Depot_y","Depot_d")

df_Release = read.table(file =paste(RepData,"/Rejets",Name_catchment,".csv",sep=""),sep=";",dec=",",header=TRUE)
head(df_Release)
names(df_Release)[3] = "DateRelease" #troisième colonne renommée
names(df_Release)[ncol(df_Release)] = "TotalRelease" #dernière colonne renommée

df_Carot = read.table(file =paste(RepData,"/Cores",Name_catchment,".csv",sep=""),sep=";",dec=",",header=TRUE)
head(df_Carot)
names(df_Carot)[1] = "Age_mean"
names(df_Carot)[4] = "Cesium137_Bq.kg..mesure."
names(df_Carot)[5] = "Cesium137_Bq.kg..depose." 

name_file_in = paste("model_Trajectory_MCMC_chain",i,".in",sep="")
#name_file_out = "trajectory.out"
name_MCMC_out = paste("trajectory.MCMC_",i,".out",sep="")

file.create(paste(RepIn,name_file_in,sep="")) #Création d'un fichier vide

############ On passe à la MCMC ici je pense ##############################

Tmig_min = 100.;
Tmig_max = 5000.;
pero_min = 0.5;
pero_max = 10.;
sigmasq_AM_par1 = 3.;
sigmasq_AM_par2 = 0.5;

Nj = 27667.;
NjD = nrow(df_Depot)*365;
NjR = df_Release$DateRelease[nrow(df_Release)] + 365

param<-paste("\t\t\t\t\t\t n0 = ", df_Parameters$n0 ,";
             nsol = ", df_Parameters$nsol,";
             z0 = ",df_Parameters$z0,";
             zmax = ",df_Parameters$zmax,";
             ro = ", df_Parameters$ro,";
             lrn =", format(df_Parameters$lrn,digits =17 ),";
             Dt =", df_Parameters$Dt,";
             Kdd =", df_Parameters$Kdd,";	
             d =", df_Parameters$d,";	
             Q =", df_Parameters$Q,";	
             SS =", df_Parameters$SS,";
             d50 =",df_Parameters$d50,";
             nsed =", df_Parameters$nsed,";
             nDepot =", nrow(df_Depot),";
             nRelease =", nrow(df_Release)+1,";
             nOutput =", nrow(df_Carot),";
             Nj =", Nj,";
             NjD =", NjD,";
             NjR =", NjR,";")

Depot =  format(df_Depot$Depot_d,digit=9)

Date_Depot = seq(0,(nrow(df_Depot)*365-365),365);

Release = c(format(df_Release$TotalRelease,digit=9),0.);

Date_Release = c(df_Release$DateRelease,NjR);

Date_min_values =floor(date_decimal(df_Carot$Age_min)-date_decimal(decimal_date(ymd("1945-06-15"))))
Date_min_values[1] = 0.

Date_min_dates = floor(date_decimal(df_Carot$Age_min)-date_decimal(decimal_date(ymd("1945-06-15"))))
Date_min_dates[1] = 0

Date_max_values = floor(date_decimal(df_Carot$Age_max)-date_decimal(decimal_date(ymd("1945-06-15"))))
Date_max_values[nrow(df_Carot)] =75*365-1

Date_max_dates = floor(date_decimal(df_Carot$Age_max)-date_decimal(decimal_date(ymd("1945-06-15"))))
Date_max_dates[nrow(df_Carot)] =75*365-1


init_averaged = rep(1,nrow(df_Carot));
time_averaged = floor(date_decimal(df_Carot$Age_mean)-date_decimal(decimal_date(ymd("1945-06-15"))))
time_averaged[length(time_averaged)] = Nj


############Ecriture dans fichier ################################

sink(file = paste(RepIn,name_file_in,sep=""))


cat("#------------------------------------------------------------------------------
# trajectory.MCMC.in
#
# Input file for MCMC simulations of a trajectory model. 
# The output of this file is a Monte Carlo sample from the joint posterior
# distribution of the parameters Tmig and pero.
#
# Copyright (c) 1993-2008 Free Software Foundation, Inc.
#------------------------------------------------------------------------------
\n")

cat("Integrate(Euler, 1);\n
MCMC (\"",Name_catchment,"/Out/Chain",i,"/",name_MCMC_out,"\",
\t\"\",                     # name of restart file
\t\"\",                     # name of data file\n\t",
nb_iter,", 0,                 # iterations, print predictions flag,
\t 1,", nb_iter,",                 # printing frequency, iters to print\n\t",
format(seed,digits =3 ),");           # random seed
\n
Level {\n" ,sep="")
cat("\t\t Distrib (Tmig, Uniform,", Tmig_min,",", Tmig_max, ");\n")
cat("\t\t Distrib (pero, Uniform,", pero_min, ",", pero_max,");\n"); 
cat("\t\t Distrib (sigmasq_AM, InvGamma,",sigmasq_AM_par1, ",", sigmasq_AM_par2, ");\n");

cat("\n\n")
cat("\t\t Depot = NDoses(")
cat(nrow(df_Depot),Depot,Date_Depot,sep=",")
cat(");\n")
cat("\n")

cat("\t\t Release = NDoses(")
cat(nrow(df_Release)+1,Release,Date_Release,sep=",")
cat(");\n")

cat("\n")
cat("\t\t Date_min = NDoses(")
cat(nrow(df_Carot),Date_min_values,Date_min_dates,sep=",")
cat(");\n")
cat("\n")
cat("\t\t Date_max = NDoses(")
cat(nrow(df_Carot),Date_max_values,Date_max_dates,sep=",")
cat(");\n")
cat("\n")

cat("\t\t Averaged = NDoses(")
cat(nrow(df_Carot),init_averaged,time_averaged,sep=",")
cat(");\n")
cat("\n")


cat("\t\t Likelihood (Averaged_out, LogNormal_v, Prediction(Averaged_out),  sigmasq_AM);\n");
cat("\n")
cat("\t\t Simulation { \n");

cat(param)
cat("\n")
cat("\n")
cat("\t\t\t\t  Print(Averaged_out", time_averaged[!is.na(df_Carot$Cesium137_Bq.kg..depose.)],sep=",")
cat(");\n")
cat("\t\t\t\t  Data(Averaged_out", df_Carot[!is.na(df_Carot$Cesium137_Bq.kg..depose.),"Cesium137_Bq.kg..depose."],sep=",")
cat(");\n")

cat("\t\t\t\t  Print(sigmasq_AM_prop", time_averaged[!is.na(df_Carot$Cesium137_Bq.kg..depose.)],sep=",")
cat(");\n")
cat("\t\t\t\t  Data(sigmasq_AM_prop", df_Carot[!is.na(df_Carot$Cesium137_Bq.kg..depose.),"Cesium137_Bq.kg..depose."],sep=",")
cat(");\n")

cat("\n")
cat("\t\t }\n")
cat("}\n\n End.")
sink()
```

## 3. Création des fichiers supp.in

**On utilise les premiers fichiers .in pour en créer de nouveaux qui permettent de simuler des chaînes de Markov à 5000 itérations (les 200 premières étant les anciennes chaînes). On le fait pour les trois différents fichiers .in de l'étape précédente.**

**Premier fichier permettant de simuler une chaîne de 200 itérations :**

```in
#------------------------------------------------------------------------------
# trajectory.MCMC.in
#
# Input file for MCMC simulations of a trajectory model. 
# The output of this file is a Monte Carlo sample from the joint posterior
# distribution of the parameters Tmig and pero.
#
# Copyright (c) 1993-2008 Free Software Foundation, Inc.
#------------------------------------------------------------------------------

Integrate(Euler, 1);

MCMC ("Loire/Out/Chain1/trajectory.MCMC_1.out",
	"",                     # name of restart file
	"",                     # name of data file
	200, 0,                 # iterations, print predictions flag,
	 1,200,                 # printing frequency, iters to print
	8695215);           # random seed


Level {
		 Distrib (Tmig, Uniform, 100 , 5000 );
		 Distrib (pero, Uniform, 0.5 , 10 );
		 Distrib (sigmasq_AM, InvGamma, 3 , 0.5 );


		 Depot = NDoses(49,6.19797e-07,4.42630e-07,6.82999e-09,6.67469e-07,1.34807e-07,8.49948e-09,3.59244e-06,3.59193e-06,1.48740e-05,3.77930e-05,5.51164e-05,4.97911e-05,4.79354e-05,6.16946e-05,1.00889e-04,2.44800e-05,3.21729e-05,1.29151e-04,2.30055e-04,1.41516e-04,6.45591e-05,2.67660e-05,1.34524e-05,1.51690e-05,1.12142e-05,1.52919e-05,1.37644e-05,6.12360e-06,2.21597e-06,8.18517e-06,3.86203e-06,1.75273e-06,5.15005e-06,6.19355e-06,1.89761e-06,1.77986e-06,2.57263e-06,7.22686e-07,4.97362e-07,3.98564e-07,1.14000e-07,3.57534e-04,3.17553e-09,1.41866e-09,6.93201e-10,4.23400e-10,2.48264e-10,1.61746e-10,7.90341e-11,0,365,730,1095,1460,1825,2190,2555,2920,3285,3650,4015,4380,4745,5110,5475,5840,6205,6570,6935,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520);

		 Release = NDoses(45,1490.36022300,1490.36022300,1490.36022300,1490.36022300,1728.18366300, 510.52765090, 412.22729580, 602.48604770, 665.90563170,  79.27447996, 130.01014710, 228.31050230,  47.56468798, 651.63622530, 700.78640280,1950.15220700, 998.85844750,1312.78538800,1312.78538800,1312.78538800,   0.00000000,   0.00000000,   0.00000000,   0.00000000,   0.00000000,  69.76154236,   0.00000000,  91.00710299, 149.35312020,  47.88178590,  50.41856925,  10.46423135,   2.82851345,  19.05758498,   5.99315068,   7.00786403,   5.29553526,  13.09614409,   6.72881786,   8.83434805,   4.83891426,   4.55669711,   3.93201421,  12.02118214,0,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520,17885,18250,18615,18980,19345,19710,20075,20440,20805,21170,21535,21900,22265,22630,22995,23360);

		 Date_min = NDoses(39,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059);

		 Date_max = NDoses(39,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374);

		 Averaged = NDoses(39,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,877,1530,2182,2834,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);

		 Likelihood (Averaged_out, LogNormal_v, Prediction(Averaged_out),  sigmasq_AM);

		 Simulation { 
						 n0 =  0.8 ;
             nsol =  0.55 ;
             z0 =  0.5 ;
             zmax =  10 ;
             ro =  0.00265 ;
             lrn = 5.9344800000000001e-05 ;
             Dt = 1 ;
             Kdd = 68000 ;	
             d = 1 ;	
             Q = 2500 ;	
             SS = 30 ;
             d50 = 35 ;
             nsed = 0.8 ;
             nDepot = 49 ;
             nRelease = 45 ;
             nOutput = 39 ;
             Nj = 27667 ;
             NjD = 17885 ;
             NjR = 23360 ;

				  Print(Averaged_out,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(Averaged_out,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);
				  Print(sigmasq_AM_prop,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(sigmasq_AM_prop,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);

		 }
}

 End.
```  

**Fichier modifié permettant de simuler une chaîne à 5000 itérations :**

```in
#------------------------------------------------------------------------------
# trajectory.MCMC.in
#
# Input file for MCMC simulations of a trajectory model. 
# The output of this file is a Monte Carlo sample from the joint posterior
# distribution of the parameters Tmig and pero.
#
# Copyright (c) 1993-2008 Free Software Foundation, Inc.
#------------------------------------------------------------------------------

Integrate(Euler, 1);

MCMC ("Loire/Out/Chain1/trajectory.MCMC_supp1.out",
	"Loire/Out/Chain1/trajectory.MCMC_1.out",                     # name of restart file
	"",                     # name of data file
	5000, 2,                 # iterations, print predictions flag,
	 1,5000,                 # printing frequency, iters to print
	8695215);           # random seed


Level {
		 Distrib (Tmig, Uniform, 100 , 5000 );
		 Distrib (pero, Uniform, 0.5 , 10 );
		 Distrib (sigmasq_AM, InvGamma, 3 , 0.5 );


		 Depot = NDoses(49,6.19797e-07,4.42630e-07,6.82999e-09,6.67469e-07,1.34807e-07,8.49948e-09,3.59244e-06,3.59193e-06,1.48740e-05,3.77930e-05,5.51164e-05,4.97911e-05,4.79354e-05,6.16946e-05,1.00889e-04,2.44800e-05,3.21729e-05,1.29151e-04,2.30055e-04,1.41516e-04,6.45591e-05,2.67660e-05,1.34524e-05,1.51690e-05,1.12142e-05,1.52919e-05,1.37644e-05,6.12360e-06,2.21597e-06,8.18517e-06,3.86203e-06,1.75273e-06,5.15005e-06,6.19355e-06,1.89761e-06,1.77986e-06,2.57263e-06,7.22686e-07,4.97362e-07,3.98564e-07,1.14000e-07,3.57534e-04,3.17553e-09,1.41866e-09,6.93201e-10,4.23400e-10,2.48264e-10,1.61746e-10,7.90341e-11,0,365,730,1095,1460,1825,2190,2555,2920,3285,3650,4015,4380,4745,5110,5475,5840,6205,6570,6935,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520);

		 Release = NDoses(45,1490.36022300,1490.36022300,1490.36022300,1490.36022300,1728.18366300, 510.52765090, 412.22729580, 602.48604770, 665.90563170,  79.27447996, 130.01014710, 228.31050230,  47.56468798, 651.63622530, 700.78640280,1950.15220700, 998.85844750,1312.78538800,1312.78538800,1312.78538800,   0.00000000,   0.00000000,   0.00000000,   0.00000000,   0.00000000,  69.76154236,   0.00000000,  91.00710299, 149.35312020,  47.88178590,  50.41856925,  10.46423135,   2.82851345,  19.05758498,   5.99315068,   7.00786403,   5.29553526,  13.09614409,   6.72881786,   8.83434805,   4.83891426,   4.55669711,   3.93201421,  12.02118214,0,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520,17885,18250,18615,18980,19345,19710,20075,20440,20805,21170,21535,21900,22265,22630,22995,23360);

		 Date_min = NDoses(39,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059);

		 Date_max = NDoses(39,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374);

		 Averaged = NDoses(39,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,877,1530,2182,2834,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);

		 Likelihood (Averaged_out, LogNormal_v, Prediction(Averaged_out),  sigmasq_AM);

		 Simulation { 
						 n0 =  0.8 ;
             nsol =  0.55 ;
             z0 =  0.5 ;
             zmax =  10 ;
             ro =  0.00265 ;
             lrn = 5.9344800000000001e-05 ;
             Dt = 1 ;
             Kdd = 68000 ;	
             d = 1 ;	
             Q = 2500 ;	
             SS = 30 ;
             d50 = 35 ;
             nsed = 0.8 ;
             nDepot = 49 ;
             nRelease = 45 ;
             nOutput = 39 ;
             Nj = 27667 ;
             NjD = 17885 ;
             NjR = 23360 ;

				  Print(Averaged_out,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(Averaged_out,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);
				  Print(sigmasq_AM_prop,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(sigmasq_AM_prop,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);

		 }
}

 End.
```

## 4. Simulation des trois petites chaînes de Markov

**On utilise le script R ci-dessous avec les premiers fichiers .in aux 200 itérations pour simuler les trois chaînes de Markov à 200 itérations. On obtient alors les trois fichiers .out correspondant aux trois simulations de chaînes de Markov à 200 itérations.**

```R
setwd("C:/Users/richa/OneDrive/Desktop/Alternance recherche/Bayesien Informatique/mcsim_under_R/MCSim_under_R/Trajectory")
rm(list = ls())
# Script for compiling and running (with MCSim) a model written in GNU MCSim
# The "mod.exe" utility must be available. If not, use the building_mod.R
# script to create it

# set the name of your model
mName = "ModelTrajectory.model"

# create a C file "mName".c from the
# GNU MCSim model definition file "mName"
# the R option generate deSolve compatible code
system(paste("../mod/mod.exe ", mName, " ", mName, ".c", sep = "")) 

# compile the MCSim executable, needs to be done each time you modify the model

# Your model executable can be linked with the GNU Scientific Library
# (GSL, recommended). If you have GSL installed the directives
# '#define HAVE_LIBGSL 1' and '#define HAVE_LIBGSLCBLAS 1' should
# appear in the config.h file, in the directory above this one. If it
# does not, put them in, alone at the beginning of a line.  If you do
# NOT have libGSL, those directives should NOT appear in that file. If
# they do, delete them.

libGSL = ""
# libGSL = "-lgsl -lgslcblas" # uncomment and execute if you have the GNU Scientific Library

system(paste("C:/msys64/ucrt64/bin/gcc.exe -O3 -I.. -I../sim -o mcsim_", mName, ".exe ", mName, ".c ../sim/*.c -lm ", libGSL, sep = "")) #crée le fichier mcsim_ModelTrajectory.model

# run the simulation input file
# put its name here

###############################################################################

#### ------------------------------------------------------####
#### Traitement du bassin versant du fleuve             ####

##########################################################
List_Catchment = c("Meuse","Loire","Moselle", "Rhin", "Rhone")#Catchment = bassin versant

Name_catchment = List_Catchment[4] #A modifier selon le fleuve

RepIn = paste(Name_catchment,"/In/",sep="")


#### Lancement des 3 chaines 
simMCMCName1 = "model_Trajectory_MCMC_chain1.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCName1, sep = ""))

simMCMCName2 = "model_Trajectory_MCMC_chain2.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCName2, sep = ""))

simMCMCName3 = "model_Trajectory_MCMC_chain3.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCName3, sep = ""))
```

**Voici un exemple, dans le cadre de la Loire, de fichier .out pouvant être obtenu et correspondant à une chaîne de Markov à 200 simulations :**

```out
iter	Tmig(1)	pero(1)	sigmasq_AM(1)	LnPrior	LnData	LnPosterior
0	1706.48	2.65507	0.11466	-9.218452e+00	-1.853175e+02	-1.945360e+02
1	1706.48	2.65507	0.11466	-9.218452e+00	-1.853175e+02	-1.945360e+02
2	1706.48	2.65507	0.165644	-9.347734e+00	-1.819567e+02	-1.913044e+02
3	2091.79	2.18607	0.320886	-1.053238e+01	-1.600736e+02	-1.706060e+02
4	3596.63	1.03722	0.237814	-9.878293e+00	-1.531462e+02	-1.630245e+02
5	3596.63	1.03722	0.237814	-9.878293e+00	-1.531462e+02	-1.630245e+02
6	3475.27	1.03722	0.237814	-9.878293e+00	-1.529773e+02	-1.628556e+02
7	3417.33	1.03722	0.237814	-9.878293e+00	-1.530217e+02	-1.629000e+02
8	3065.56	1.03722	0.237814	-9.878293e+00	-1.529048e+02	-1.627831e+02
9	3065.56	1.03722	0.237814	-9.878293e+00	-1.529048e+02	-1.627831e+02
10	2984.91	1.15804	0.237814	-9.878293e+00	-1.533838e+02	-1.632621e+02
11	2984.91	1.15804	0.314448	-1.048322e+01	-1.536155e+02	-1.640987e+02
12	2984.91	1.15804	0.333934	-1.063092e+01	-1.538468e+02	-1.644778e+02
13	2984.91	1.15804	0.209992	-9.659170e+00	-1.543154e+02	-1.639746e+02
14	3750.84	1.15804	0.209992	-9.659170e+00	-1.544142e+02	-1.640734e+02
15	3912.54	1.91877	0.222179	-9.754218e+00	-1.535764e+02	-1.633306e+02
16	3912.54	1.91877	0.202072	-9.598713e+00	-1.542075e+02	-1.638062e+02
17	3506.41	1.91877	0.243166	-9.921039e+00	-1.538115e+02	-1.637325e+02
18	3506.41	1.48124	0.243166	-9.921039e+00	-1.533046e+02	-1.632256e+02
19	3506.41	1.48124	0.243166	-9.921039e+00	-1.533046e+02	-1.632256e+02
20	3506.41	1.48124	0.243166	-9.921039e+00	-1.533046e+02	-1.632256e+02
21	4068.2	1.48124	0.243166	-9.921039e+00	-1.534892e+02	-1.634102e+02
22	2890.4	1.48124	0.243166	-9.921039e+00	-1.528528e+02	-1.627738e+02
23	2890.4	1.61313	0.243166	-9.921039e+00	-1.532962e+02	-1.632173e+02
24	2890.4	1.61313	0.243166	-9.921039e+00	-1.532962e+02	-1.632173e+02
25	2890.4	1.61313	0.243166	-9.921039e+00	-1.532962e+02	-1.632173e+02
26	2890.4	1.61313	0.243166	-9.921039e+00	-1.532962e+02	-1.632173e+02
27	3695.22	1.06845	0.243166	-9.921039e+00	-1.531449e+02	-1.630660e+02
28	3029.44	1.06845	0.221436	-9.748370e+00	-1.536960e+02	-1.634443e+02
29	4002.92	1.06845	0.221436	-9.748370e+00	-1.548121e+02	-1.645605e+02
30	3582.07	1.06845	0.20953	-9.655611e+00	-1.536436e+02	-1.632992e+02
31	3691.05	1.06845	0.20953	-9.655611e+00	-1.537707e+02	-1.634263e+02
32	3624.05	1.06845	0.213931	-9.689664e+00	-1.534807e+02	-1.631704e+02
33	3624.05	1.11321	0.213931	-9.689664e+00	-1.529154e+02	-1.626051e+02
34	3624.05	1.11321	0.213931	-9.689664e+00	-1.529154e+02	-1.626051e+02
35	3624.05	1.11321	0.213931	-9.689664e+00	-1.529154e+02	-1.626051e+02
36	3624.05	1.11321	0.213931	-9.689664e+00	-1.529154e+02	-1.626051e+02
37	3441.33	1.11321	0.247562	-9.956191e+00	-1.528916e+02	-1.628478e+02
38	3779.05	1.11321	0.247562	-9.956191e+00	-1.533789e+02	-1.633351e+02
39	3391.35	0.859921	0.247562	-9.956191e+00	-1.532855e+02	-1.632417e+02
40	3483.56	0.859921	0.247562	-9.956191e+00	-1.534069e+02	-1.633631e+02
41	2738.15	1.78509	0.247562	-9.956191e+00	-1.552868e+02	-1.652430e+02
42	2975.76	0.723701	0.325671	-1.056869e+01	-1.537288e+02	-1.642975e+02
43	2975.76	0.723701	0.325671	-1.056869e+01	-1.537288e+02	-1.642975e+02
44	3276.12	0.723701	0.29292	-1.031640e+01	-1.535770e+02	-1.638934e+02
45	3158.93	1.9363	0.29292	-1.031640e+01	-1.541211e+02	-1.644375e+02
46	3526.51	1.9363	0.369094	-1.088872e+01	-1.541857e+02	-1.650744e+02
47	3537.75	1.9363	0.326523	-1.057513e+01	-1.537621e+02	-1.643372e+02
48	3617.43	1.9363	0.326523	-1.057513e+01	-1.536890e+02	-1.642641e+02
49	3617.43	1.9363	0.306203	-1.041974e+01	-1.535047e+02	-1.639244e+02
50	4479.02	1.9363	0.306203	-1.041974e+01	-1.539599e+02	-1.643796e+02
51	4133.67	1.9363	0.275453	-1.017871e+01	-1.532548e+02	-1.634335e+02
52	4566.24	1.9363	0.275453	-1.017871e+01	-1.536890e+02	-1.638677e+02
53	3585.94	1.2717	0.289129	-1.028667e+01	-1.528291e+02	-1.631158e+02
54	4561.99	1.00269	0.291855	-1.030806e+01	-1.546478e+02	-1.649559e+02
55	4289.05	1.83108	0.228641	-9.805298e+00	-1.534506e+02	-1.632559e+02
56	4712.13	1.83108	0.228641	-9.805298e+00	-1.542601e+02	-1.640654e+02
57	4281.47	1.8872	0.260129	-1.005668e+01	-1.532080e+02	-1.632647e+02
58	4733.35	2.08976	0.278517	-1.020299e+01	-1.537109e+02	-1.639139e+02
59	4537.75	2.18453	0.355636	-1.079142e+01	-1.541610e+02	-1.649524e+02
60	4177.32	1.50745	0.318859	-1.051694e+01	-1.532706e+02	-1.637875e+02
61	4216.09	1.50745	0.306024	-1.041836e+01	-1.532456e+02	-1.636639e+02
62	4280.44	1.34012	0.306024	-1.041836e+01	-1.534337e+02	-1.638521e+02
63	3462.53	1.34012	0.306024	-1.041836e+01	-1.524384e+02	-1.628568e+02
64	3411.02	1.55866	0.306024	-1.041836e+01	-1.530884e+02	-1.635068e+02
65	2535.91	0.842873	0.312293	-1.046668e+01	-1.542624e+02	-1.647291e+02
66	2535.91	0.842873	0.290893	-1.030052e+01	-1.542063e+02	-1.645068e+02
67	3392.57	1.44748	0.314241	-1.048162e+01	-1.530852e+02	-1.635668e+02
68	3392.57	1.44748	0.296199	-1.034203e+01	-1.530032e+02	-1.633453e+02
69	3053.76	1.54834	0.296199	-1.034203e+01	-1.535145e+02	-1.638565e+02
70	 3883	2.04312	0.191999	-9.523994e+00	-1.547933e+02	-1.643173e+02
71	3789.09	2.16332	0.191999	-9.523994e+00	-1.553134e+02	-1.648374e+02
72	3789.09	2.16332	0.191999	-9.523994e+00	-1.553134e+02	-1.648374e+02
73	3789.09	2.16332	0.274089	-1.016789e+01	-1.538309e+02	-1.639988e+02
74	3558.98	2.16332	0.319629	-1.052281e+01	-1.542120e+02	-1.647348e+02
75	3558.98	1.28225	0.319629	-1.052281e+01	-1.535960e+02	-1.641188e+02
76	3558.98	 2.23	0.319629	-1.052281e+01	-1.537138e+02	-1.642366e+02
77	3558.98	0.787042	0.319629	-1.052281e+01	-1.536458e+02	-1.641686e+02
78	3307.15	1.11015	0.319629	-1.052281e+01	-1.531413e+02	-1.636641e+02
79	3307.15	1.11015	0.342244	-1.069289e+01	-1.534297e+02	-1.641226e+02
80	3307.15	1.11015	0.382972	-1.098728e+01	-1.539203e+02	-1.649076e+02
81	2254.6	1.03273	0.36095	-1.083004e+01	-1.555858e+02	-1.664158e+02
82	2469.84	1.03273	0.36095	-1.083004e+01	-1.550921e+02	-1.659222e+02
83	3016.35	0.551715	0.313492	-1.047588e+01	-1.539277e+02	-1.644036e+02
84	3016.35	0.551715	0.313492	-1.047588e+01	-1.539277e+02	-1.644036e+02
85	3088.15	2.1526	0.374266	-1.092566e+01	-1.554686e+02	-1.663943e+02
86	3088.15	2.1526	0.374266	-1.092566e+01	-1.554686e+02	-1.663943e+02
87	3573.13	2.2722	0.367498	-1.087727e+01	-1.548565e+02	-1.657338e+02
88	4856.82	2.2722	0.35414	-1.078049e+01	-1.544367e+02	-1.652172e+02
89	3984.95	2.2722	0.277666	-1.019625e+01	-1.540258e+02	-1.642221e+02
90	4279.48	2.24979	0.277666	-1.019625e+01	-1.537356e+02	-1.639319e+02
91	4213.74	2.24979	0.277666	-1.019625e+01	-1.537052e+02	-1.639015e+02
92	3792.94	2.24979	0.276833	-1.018965e+01	-1.540997e+02	-1.642894e+02
93	4419.39	2.24979	0.314248	-1.048168e+01	-1.538979e+02	-1.643796e+02
94	4881.73	1.9657	0.258914	-1.004698e+01	-1.539015e+02	-1.639485e+02
95	4690.26	1.9657	0.306593	-1.042276e+01	-1.537164e+02	-1.641391e+02
96	4716.5	1.9657	0.306593	-1.042276e+01	-1.537085e+02	-1.641313e+02
97	4360.82	1.9657	0.254654	-1.001292e+01	-1.534413e+02	-1.634542e+02
98	4866.67	2.55102	0.254654	-1.001292e+01	-1.546575e+02	-1.646704e+02
99	4548.73	2.55102	0.254654	-1.001292e+01	-1.544480e+02	-1.644609e+02
100	4977.95	2.55102	0.349448	-1.074609e+01	-1.548780e+02	-1.656241e+02
101	4552.96	1.89838	0.349448	-1.074609e+01	-1.539067e+02	-1.646528e+02
102	3700.62	1.89838	0.349448	-1.074609e+01	-1.533305e+02	-1.640766e+02
103	3700.62	1.89838	0.349448	-1.074609e+01	-1.533305e+02	-1.640766e+02
104	3420.48	1.13872	0.349448	-1.074609e+01	-1.534653e+02	-1.642114e+02
105	2966.18	1.13872	0.277936	-1.019839e+01	-1.532962e+02	-1.634946e+02
106	2966.18	1.13872	0.277936	-1.019839e+01	-1.532962e+02	-1.634946e+02
107	3963.62	2.02122	0.250344	-9.978448e+00	-1.534133e+02	-1.633918e+02
108	4695.55	2.02122	0.273133	-1.016030e+01	-1.536583e+02	-1.638185e+02
109	4541.01	2.02122	0.273133	-1.016030e+01	-1.534035e+02	-1.635638e+02
110	4629.76	1.8992	0.273133	-1.016030e+01	-1.535038e+02	-1.636641e+02
111	4660.87	2.20103	0.273133	-1.016030e+01	-1.537667e+02	-1.639270e+02
112	3573.6	0.946796	0.256371	-1.002665e+01	-1.531550e+02	-1.631817e+02
113	3142.33	0.946796	0.254178	-1.000911e+01	-1.532394e+02	-1.632485e+02
114	3142.33	0.948192	0.254178	-1.000911e+01	-1.546469e+02	-1.646560e+02
115	3702.73	1.80768	0.254178	-1.000911e+01	-1.530760e+02	-1.630851e+02
116	3631.68	1.80768	0.254178	-1.000911e+01	-1.531070e+02	-1.631161e+02
117	3249.84	1.80768	0.254178	-1.000911e+01	-1.533703e+02	-1.633794e+02
118	3337.48	2.07609	0.252899	-9.998886e+00	-1.543594e+02	-1.643583e+02
119	3221.97	2.0595	0.373254	-1.091846e+01	-1.549221e+02	-1.658405e+02
120	4564.22	2.0595	0.373254	-1.091846e+01	-1.549475e+02	-1.658659e+02
121	4540.69	2.0595	0.373254	-1.091846e+01	-1.542426e+02	-1.651610e+02
122	4065.88	1.03514	0.374375	-1.092644e+01	-1.542797e+02	-1.652062e+02
123	4065.88	1.00581	0.374375	-1.092644e+01	-1.540132e+02	-1.649396e+02
124	3374.89	0.531179	0.374375	-1.092644e+01	-1.546420e+02	-1.655684e+02
125	3822.84	0.531179	0.324801	-1.056211e+01	-1.547944e+02	-1.653565e+02
126	4260.05	0.846105	0.324801	-1.056211e+01	-1.545319e+02	-1.650940e+02
127	4260.05	1.42494	0.324801	-1.056211e+01	-1.531955e+02	-1.637576e+02
128	4204.29	0.625804	0.298074	-1.035665e+01	-1.551119e+02	-1.654686e+02
129	4187.35	1.64162	0.28801	-1.027788e+01	-1.530491e+02	-1.633270e+02
130	3298.85	1.64162	0.28801	-1.027788e+01	-1.526140e+02	-1.628919e+02
131	3298.85	1.33725	0.28801	-1.027788e+01	-1.525899e+02	-1.628678e+02
132	2856.23	0.586295	0.28801	-1.027788e+01	-1.538919e+02	-1.641698e+02
133	2582.8	0.586295	0.28801	-1.027788e+01	-1.539842e+02	-1.642621e+02
134	2979.11	1.62709	0.28801	-1.027788e+01	-1.537691e+02	-1.640470e+02
135	2979.11	1.62709	0.28801	-1.027788e+01	-1.537691e+02	-1.640470e+02
136	4213.63	0.838365	0.28801	-1.027788e+01	-1.543930e+02	-1.646709e+02
137	3537.12	1.08629	0.28801	-1.027788e+01	-1.529349e+02	-1.632128e+02
138	4109.27	2.68098	0.194541	-9.542572e+00	-1.572026e+02	-1.667452e+02
139	4109.27	2.68098	0.429618	-1.130526e+01	-1.561124e+02	-1.674176e+02
140	4718.31	1.14182	0.429618	-1.130526e+01	-1.558160e+02	-1.671213e+02
141	2447.2	1.14182	0.429618	-1.130526e+01	-1.546109e+02	-1.659162e+02
142	2021.56	1.14182	0.429618	-1.130526e+01	-1.568913e+02	-1.681966e+02
143	2021.56	1.14182	0.31707	-1.050328e+01	-1.567557e+02	-1.672590e+02
144	1906.14	1.14182	0.31707	-1.050328e+01	-1.573333e+02	-1.678366e+02
145	2411.19	0.845655	0.283038	-1.023872e+01	-1.546221e+02	-1.648608e+02
146	2500.75	0.845655	0.283038	-1.023872e+01	-1.544354e+02	-1.646741e+02
147	2365.74	0.845655	0.283038	-1.023872e+01	-1.546120e+02	-1.648508e+02
148	2829.4	0.845655	0.283038	-1.023872e+01	-1.541122e+02	-1.643509e+02
149	2829.4	0.845655	0.259067	-1.004820e+01	-1.536279e+02	-1.636761e+02
150	3289.43	0.845655	0.225783	-9.782666e+00	-1.536773e+02	-1.634600e+02
151	3052.26	0.845655	0.252477	-9.995505e+00	-1.534696e+02	-1.634651e+02
152	2493.1	1.01915	0.252477	-9.995505e+00	-1.545658e+02	-1.645613e+02
153	2493.1	1.01915	0.252477	-9.995505e+00	-1.545658e+02	-1.645613e+02
154	2135.44	1.01915	0.252477	-9.995505e+00	-1.558423e+02	-1.658378e+02
155	2579.5	1.09588	0.252477	-9.995505e+00	-1.543021e+02	-1.642976e+02
156	2679.56	1.09588	0.252477	-9.995505e+00	-1.541040e+02	-1.640995e+02
157	3974.91	1.09588	0.286494	-1.026596e+01	-1.533604e+02	-1.636263e+02
158	3524.7	1.09588	0.219489	-9.733075e+00	-1.532740e+02	-1.630070e+02
159	3524.7	1.09588	0.219489	-9.733075e+00	-1.532740e+02	-1.630070e+02
160	3524.7	1.09588	0.219489	-9.733075e+00	-1.532740e+02	-1.630070e+02
161	3110.27	1.04492	0.219489	-9.733075e+00	-1.534940e+02	-1.632271e+02
162	3110.27	1.85497	0.219489	-9.733075e+00	-1.549035e+02	-1.646365e+02
163	3099.62	1.85497	0.219489	-9.733075e+00	-1.547752e+02	-1.645083e+02
164	3099.62	1.85497	0.219489	-9.733075e+00	-1.547752e+02	-1.645083e+02
165	 3593	1.85497	0.24963	-9.972730e+00	-1.534432e+02	-1.634159e+02
166	3204.87	1.44952	0.24963	-9.972730e+00	-1.531545e+02	-1.631272e+02
167	3652.08	1.44952	0.24963	-9.972730e+00	-1.532072e+02	-1.631800e+02
168	4210.53	1.44952	0.24963	-9.972730e+00	-1.535887e+02	-1.635614e+02
169	4383.68	1.44952	0.24963	-9.972730e+00	-1.535491e+02	-1.635219e+02
170	4638.58	0.838642	0.24963	-9.972730e+00	-1.558574e+02	-1.658302e+02
171	3532.73	1.52351	0.24963	-9.972730e+00	-1.528448e+02	-1.628175e+02
172	3532.73	2.82838	0.24963	-9.972730e+00	-1.569088e+02	-1.668816e+02
173	3532.73	2.82838	0.24963	-9.972730e+00	-1.569088e+02	-1.668816e+02
174	4450.95	2.44517	0.24963	-9.972730e+00	-1.543870e+02	-1.643598e+02
175	4450.95	2.44517	0.24963	-9.972730e+00	-1.543870e+02	-1.643598e+02
176	4060.22	0.852368	0.218257	-9.723424e+00	-1.547300e+02	-1.644534e+02
177	4041.63	0.852368	0.218257	-9.723424e+00	-1.546691e+02	-1.643926e+02
178	3345.47	0.852368	0.236041	-9.864145e+00	-1.534678e+02	-1.633319e+02
179	3345.47	1.18511	0.236041	-9.864145e+00	-1.519866e+02	-1.618508e+02
180	3625.71	1.71827	0.236041	-9.864145e+00	-1.531358e+02	-1.630000e+02
181	4188.75	1.71827	0.245507	-9.939754e+00	-1.531701e+02	-1.631099e+02
182	4043.94	1.71827	0.245507	-9.939754e+00	-1.529293e+02	-1.628690e+02
183	3131.52	1.71827	0.245507	-9.939754e+00	-1.530262e+02	-1.629659e+02
184	3131.52	1.71827	0.245507	-9.939754e+00	-1.530262e+02	-1.629659e+02
185	3131.52	1.71827	0.245507	-9.939754e+00	-1.530262e+02	-1.629659e+02
186	3330.23	1.71827	0.245507	-9.939754e+00	-1.536177e+02	-1.635575e+02
187	3007.06	1.64244	0.245507	-9.939754e+00	-1.539562e+02	-1.638959e+02
188	3007.06	1.64244	0.245507	-9.939754e+00	-1.539562e+02	-1.638959e+02
189	4308.47	0.85026	0.245507	-9.939754e+00	-1.548831e+02	-1.648229e+02
190	4308.47	0.85026	0.257727	-1.003749e+01	-1.548198e+02	-1.648573e+02
191	3692.4	0.637202	0.257727	-1.003749e+01	-1.541531e+02	-1.641906e+02
192	3692.4	0.763403	0.257727	-1.003749e+01	-1.530725e+02	-1.631100e+02
193	3692.4	0.965299	0.257727	-1.003749e+01	-1.531076e+02	-1.631450e+02
194	3454.49	0.965299	0.257727	-1.003749e+01	-1.528564e+02	-1.628939e+02
195	3454.49	0.965299	0.216004	-9.705810e+00	-1.536084e+02	-1.633142e+02
196	3454.49	0.93671	0.216004	-9.705810e+00	-1.524237e+02	-1.621295e+02
197	3454.49	1.25223	0.274991	-1.017504e+01	-1.527917e+02	-1.629667e+02
198	3892.6	0.94032	0.274991	-1.017504e+01	-1.534987e+02	-1.636737e+02
199	4127.86	 1.51	0.274991	-1.017504e+01	-1.529647e+02	-1.631398e+02
200	4127.86	 1.51	0.274991	-1.017504e+01	-1.529647e+02	-1.631398e+02
```

## 5. Simulation des trois grandes chaînes de Markov

**Grâce au script R ci-dessous, on simule les trois chaîne de Markov à 5000 itérations.
On obtient alors les trois fichiers .out correspondant aux trois chaînes de Markov à 4800 itérations simulées (les 200 premières constituant le burn-in, les petites chaînes simulées juste avant).**

```R
setwd("C:/Users/richa/OneDrive/Desktop/Alternance recherche/Bayesien Informatique/mcsim_under_R/MCSim_under_R/Trajectory")
rm(list = ls())
# Script for compiling and running (with MCSim) a model written in GNU MCSim
# The "mod.exe" utility must be available. If not, use the building_mod.R
# script to create it

# set the name of your model
mName = "ModelTrajectory.model"

# create a C file "mName".c from the
# GNU MCSim model definition file "mName"
# the R option generate deSolve compatible code
system(paste("../mod/mod.exe ", mName, " ", mName, ".c", sep = "")) 

# compile the MCSim executable, needs to be done each time you modify the model

# Your model executable can be linked with the GNU Scientific Library
# (GSL, recommended). If you have GSL installed the directives
# '#define HAVE_LIBGSL 1' and '#define HAVE_LIBGSLCBLAS 1' should
# appear in the config.h file, in the directory above this one. If it
# does not, put them in, alone at the beginning of a line.  If you do
# NOT have libGSL, those directives should NOT appear in that file. If
# they do, delete them.

libGSL = ""
# libGSL = "-lgsl -lgslcblas" # uncomment and execute if you have the GNU Scientific Library

system(paste("C:/msys64/ucrt64/bin/gcc.exe -O3 -I.. -I../sim -o mcsim_", mName, ".exe ", mName, ".c ../sim/*.c -lm ", libGSL, sep = "")) #crée le fichier mcsim_ModelTrajectory.model

# run the simulation input file
# put its name here

###############################################################################

#### ------------------------------------------------------####
#### Traitement du bassin versant du fleuve             ####

##########################################################
List_Catchment = c("Meuse","Loire","Moselle", "Rhin", "Rhone")#Catchment = bassin versant

Name_catchment = List_Catchment[4] #A modifier selon le fleuve

RepIn = paste(Name_catchment,"/In/",sep="")

#### Lancement des 3 chaines supp 
simMCMCNamesupp1 = "model_Trajectory_MCMCsupp_chain1.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCNamesupp1, sep = ""))

simMCMCNamesupp2 = "model_Trajectory_MCMCsupp_chain2.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCNamesupp2, sep = ""))

simMCMCNamesupp3 = "model_Trajectory_MCMCsupp_chain3.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCNamesupp3, sep = ""))
```

**Exemple de chaîne obtenue à partir dans le cadre de la Loire :**

```out
iter	Tmig(1)	pero(1)	sigmasq_AM(1)	LnPrior	LnData	LnPosterior
201	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
202	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
203	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
204	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
205	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
206	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
207	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
208	3636.98	1.5332	0.202757	-9.603889e+00	-1.528017e+02	-1.624056e+02
209	3636.98	1.5332	0.202757	-9.603889e+00	-1.528017e+02	-1.624056e+02
.
.
.
.
4990	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4991	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4992	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4993	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4994	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4995	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4996	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4997	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4998	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4999	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
5000	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
```
