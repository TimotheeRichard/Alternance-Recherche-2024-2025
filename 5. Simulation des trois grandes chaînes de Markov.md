## Simulation des trois grandes chaînes de Markov

**Grâce au script R ci-dessous, on simule les trois chaîne de Markov à 5000 itérations.
On obtient alors les trois fichiers .out correspondant aux trois chaînes de Markov à 4800 itérations simulées (les 200 premières constituant le burn-in, les petites chaînes simulées juste avant).**

```R
setwd("C:/Users/richa/OneDrive/Desktop/Alternance recherche/Bayesien Informatique/mcsim_under_R/MCSim_under_R/Trajectory")
rm(list = ls())
# Script for compiling and running (with MCSim) a model written in GNU MCSim
# The "mod.exe" utility must be available. If not, use the building_mod.R
# script to create it

# set the name of your model
mName = "ModelTrajectory.model"

# create a C file "mName".c from the
# GNU MCSim model definition file "mName"
# the R option generate deSolve compatible code
system(paste("../mod/mod.exe ", mName, " ", mName, ".c", sep = "")) 

# compile the MCSim executable, needs to be done each time you modify the model

# Your model executable can be linked with the GNU Scientific Library
# (GSL, recommended). If you have GSL installed the directives
# '#define HAVE_LIBGSL 1' and '#define HAVE_LIBGSLCBLAS 1' should
# appear in the config.h file, in the directory above this one. If it
# does not, put them in, alone at the beginning of a line.  If you do
# NOT have libGSL, those directives should NOT appear in that file. If
# they do, delete them.

libGSL = ""
# libGSL = "-lgsl -lgslcblas" # uncomment and execute if you have the GNU Scientific Library

system(paste("C:/msys64/ucrt64/bin/gcc.exe -O3 -I.. -I../sim -o mcsim_", mName, ".exe ", mName, ".c ../sim/*.c -lm ", libGSL, sep = "")) #crée le fichier mcsim_ModelTrajectory.model

# run the simulation input file
# put its name here

###############################################################################

#### ------------------------------------------------------####
#### Traitement du bassin versant du fleuve             ####

##########################################################
List_Catchment = c("Meuse","Loire","Moselle", "Rhin", "Rhone")#Catchment = bassin versant

Name_catchment = List_Catchment[4] #A modifier selon le fleuve

RepIn = paste(Name_catchment,"/In/",sep="")

#### Lancement des 3 chaines supp 
simMCMCNamesupp1 = "model_Trajectory_MCMCsupp_chain1.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCNamesupp1, sep = ""))

simMCMCNamesupp2 = "model_Trajectory_MCMCsupp_chain2.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCNamesupp2, sep = ""))

simMCMCNamesupp3 = "model_Trajectory_MCMCsupp_chain3.in"
# run!
system(paste("./mcsim_", mName, ".exe ",RepIn, simMCMCNamesupp3, sep = ""))
```

**Exemple de chaîne obtenue à partir dans le cadre de la Loire :**

```out
iter	Tmig(1)	pero(1)	sigmasq_AM(1)	LnPrior	LnData	LnPosterior
201	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
202	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
203	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
204	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
205	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
206	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
207	4127.86	 1.51	0.274991	-1.017504e+01	-1.498322e+02	-1.600073e+02
208	3636.98	1.5332	0.202757	-9.603889e+00	-1.528017e+02	-1.624056e+02
209	3636.98	1.5332	0.202757	-9.603889e+00	-1.528017e+02	-1.624056e+02
.
.
.
.
4990	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4991	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4992	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4993	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4994	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4995	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4996	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4997	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4998	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
4999	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
5000	2824.8	1.5512	0.284459	-1.024993e+01	-1.526774e+02	-1.629273e+02
```
