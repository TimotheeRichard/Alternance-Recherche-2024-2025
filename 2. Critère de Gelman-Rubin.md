## Critère de Gelman-Rubin

**Sert à évaluer la convergence des MCMC, permet de déterminer si les chaines MCMC ont convergé vers la distribution cible.**

On a plusieurs chaînes MCMC avec des conditions initiales différentes. On va alors comparer les variances intra-chaîne et inter-chaîne. 

Si les chaînes ont convergé vers la même distribution cible, les variances devraient être similaires.
On a m chaînes de longueur n.

**_Calculer la moyenne de chaque chaîne :_**

$$
\bar{\theta_i} = \frac{1}{n} \sum_{j=1}^{n} \theta_{i,j}
$$

**_Calculer la moyenne globale :_**

$$
\bar{\theta} = \frac{1}{m} \sum_{i=1}^{m} \bar{\theta_i}
$$

**_Calculer la variance intra-chaîne W :_**

$$
W = \frac{1}{m} \sum_{i=1}^{m} (\frac{1}{n-1} \sum_{j=1}^{n} (\theta_{i,j} - \bar{\theta_i})^2)
$$
 
**_Calculer la variance inter-chaîne B :_**

$$
B = \frac{n}{m-1} \sum_{i=1}^{m} (\bar{\theta_i} - \bar{\theta})^2
$$

**_Combiner les variances pour obtenir l'estimateur de la variance totale :_**

$$
\hat{V} = \frac{n-1}{n} W + \frac{1}{n} B
$$

**_Calculer le critère de Gelman-Rubin :_**

$$
\hat{R} = \sqrt{\frac{\hat{V}}{W}}
$$
 
**_Interprétation :_**

- **R≈1** : Indique que les chaînes ont probablement convergé vers la même distribution cible. Un R proche de 1 (typiquement R<1.1) est souvent utilisé comme critère de convergence.

- **R>1** : Indique que les chaînes n'ont pas encore convergé. Cela signifie qu'il y a encore une différence notable entre les variances intra-chaîne et inter-chaîne, suggérant que plus de simulations sont nécessaires.
