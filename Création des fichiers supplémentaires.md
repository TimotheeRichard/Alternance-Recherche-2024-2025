## Création des fichiers supp.in

**On utilise les premiers fichiers .in pour en créer de nouveaux qui permettent de simuler des chaînes de Markov à 5000 itérations (les 200 premières étant les anciennes chaînes). On le fait pour les trois différents fichiers .in de l'étape précédente.**

**Premier fichier permettant de simuler une chaîne de 200 itérations :**

```in
#------------------------------------------------------------------------------
# trajectory.MCMC.in
#
# Input file for MCMC simulations of a trajectory model. 
# The output of this file is a Monte Carlo sample from the joint posterior
# distribution of the parameters Tmig and pero.
#
# Copyright (c) 1993-2008 Free Software Foundation, Inc.
#------------------------------------------------------------------------------

Integrate(Euler, 1);

MCMC ("Loire/Out/Chain1/trajectory.MCMC_1.out",
	"",                     # name of restart file
	"",                     # name of data file
	200, 0,                 # iterations, print predictions flag,
	 1,200,                 # printing frequency, iters to print
	8695215);           # random seed


Level {
		 Distrib (Tmig, Uniform, 100 , 5000 );
		 Distrib (pero, Uniform, 0.5 , 10 );
		 Distrib (sigmasq_AM, InvGamma, 3 , 0.5 );


		 Depot = NDoses(49,6.19797e-07,4.42630e-07,6.82999e-09,6.67469e-07,1.34807e-07,8.49948e-09,3.59244e-06,3.59193e-06,1.48740e-05,3.77930e-05,5.51164e-05,4.97911e-05,4.79354e-05,6.16946e-05,1.00889e-04,2.44800e-05,3.21729e-05,1.29151e-04,2.30055e-04,1.41516e-04,6.45591e-05,2.67660e-05,1.34524e-05,1.51690e-05,1.12142e-05,1.52919e-05,1.37644e-05,6.12360e-06,2.21597e-06,8.18517e-06,3.86203e-06,1.75273e-06,5.15005e-06,6.19355e-06,1.89761e-06,1.77986e-06,2.57263e-06,7.22686e-07,4.97362e-07,3.98564e-07,1.14000e-07,3.57534e-04,3.17553e-09,1.41866e-09,6.93201e-10,4.23400e-10,2.48264e-10,1.61746e-10,7.90341e-11,0,365,730,1095,1460,1825,2190,2555,2920,3285,3650,4015,4380,4745,5110,5475,5840,6205,6570,6935,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520);

		 Release = NDoses(45,1490.36022300,1490.36022300,1490.36022300,1490.36022300,1728.18366300, 510.52765090, 412.22729580, 602.48604770, 665.90563170,  79.27447996, 130.01014710, 228.31050230,  47.56468798, 651.63622530, 700.78640280,1950.15220700, 998.85844750,1312.78538800,1312.78538800,1312.78538800,   0.00000000,   0.00000000,   0.00000000,   0.00000000,   0.00000000,  69.76154236,   0.00000000,  91.00710299, 149.35312020,  47.88178590,  50.41856925,  10.46423135,   2.82851345,  19.05758498,   5.99315068,   7.00786403,   5.29553526,  13.09614409,   6.72881786,   8.83434805,   4.83891426,   4.55669711,   3.93201421,  12.02118214,0,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520,17885,18250,18615,18980,19345,19710,20075,20440,20805,21170,21535,21900,22265,22630,22995,23360);

		 Date_min = NDoses(39,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059);

		 Date_max = NDoses(39,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374);

		 Averaged = NDoses(39,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,877,1530,2182,2834,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);

		 Likelihood (Averaged_out, LogNormal_v, Prediction(Averaged_out),  sigmasq_AM);

		 Simulation { 
						 n0 =  0.8 ;
             nsol =  0.55 ;
             z0 =  0.5 ;
             zmax =  10 ;
             ro =  0.00265 ;
             lrn = 5.9344800000000001e-05 ;
             Dt = 1 ;
             Kdd = 68000 ;	
             d = 1 ;	
             Q = 2500 ;	
             SS = 30 ;
             d50 = 35 ;
             nsed = 0.8 ;
             nDepot = 49 ;
             nRelease = 45 ;
             nOutput = 39 ;
             Nj = 27667 ;
             NjD = 17885 ;
             NjR = 23360 ;

				  Print(Averaged_out,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(Averaged_out,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);
				  Print(sigmasq_AM_prop,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(sigmasq_AM_prop,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);

		 }
}

 End.
```  

**Fichier modifié permettant de simuler une chaîne à 5000 itérations :**

```in
#------------------------------------------------------------------------------
# trajectory.MCMC.in
#
# Input file for MCMC simulations of a trajectory model. 
# The output of this file is a Monte Carlo sample from the joint posterior
# distribution of the parameters Tmig and pero.
#
# Copyright (c) 1993-2008 Free Software Foundation, Inc.
#------------------------------------------------------------------------------

Integrate(Euler, 1);

MCMC ("Loire/Out/Chain1/trajectory.MCMC_supp1.out",
	"Loire/Out/Chain1/trajectory.MCMC_1.out",                     # name of restart file
	"",                     # name of data file
	5000, 2,                 # iterations, print predictions flag,
	 1,5000,                 # printing frequency, iters to print
	8695215);           # random seed


Level {
		 Distrib (Tmig, Uniform, 100 , 5000 );
		 Distrib (pero, Uniform, 0.5 , 10 );
		 Distrib (sigmasq_AM, InvGamma, 3 , 0.5 );


		 Depot = NDoses(49,6.19797e-07,4.42630e-07,6.82999e-09,6.67469e-07,1.34807e-07,8.49948e-09,3.59244e-06,3.59193e-06,1.48740e-05,3.77930e-05,5.51164e-05,4.97911e-05,4.79354e-05,6.16946e-05,1.00889e-04,2.44800e-05,3.21729e-05,1.29151e-04,2.30055e-04,1.41516e-04,6.45591e-05,2.67660e-05,1.34524e-05,1.51690e-05,1.12142e-05,1.52919e-05,1.37644e-05,6.12360e-06,2.21597e-06,8.18517e-06,3.86203e-06,1.75273e-06,5.15005e-06,6.19355e-06,1.89761e-06,1.77986e-06,2.57263e-06,7.22686e-07,4.97362e-07,3.98564e-07,1.14000e-07,3.57534e-04,3.17553e-09,1.41866e-09,6.93201e-10,4.23400e-10,2.48264e-10,1.61746e-10,7.90341e-11,0,365,730,1095,1460,1825,2190,2555,2920,3285,3650,4015,4380,4745,5110,5475,5840,6205,6570,6935,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520);

		 Release = NDoses(45,1490.36022300,1490.36022300,1490.36022300,1490.36022300,1728.18366300, 510.52765090, 412.22729580, 602.48604770, 665.90563170,  79.27447996, 130.01014710, 228.31050230,  47.56468798, 651.63622530, 700.78640280,1950.15220700, 998.85844750,1312.78538800,1312.78538800,1312.78538800,   0.00000000,   0.00000000,   0.00000000,   0.00000000,   0.00000000,  69.76154236,   0.00000000,  91.00710299, 149.35312020,  47.88178590,  50.41856925,  10.46423135,   2.82851345,  19.05758498,   5.99315068,   7.00786403,   5.29553526,  13.09614409,   6.72881786,   8.83434805,   4.83891426,   4.55669711,   3.93201421,  12.02118214,0,7300,7665,8030,8395,8760,9125,9490,9855,10220,10585,10950,11315,11680,12045,12410,12775,13140,13505,13870,14235,14600,14965,15330,15695,16060,16425,16790,17155,17520,17885,18250,18615,18980,19345,19710,20075,20440,20805,21170,21535,21900,22265,22630,22995,23360);

		 Date_min = NDoses(39,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,0,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059);

		 Date_max = NDoses(39,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374,1186,1843,2500,3158,3815,4582,5312,6043,6737,7286,7869,8454,9002,9513,9952,10426,10901,11376,11851,12289,12764,13202,13604,13932,14298,14627,15138,16161,17037,17950,18827,19740,20617,21530,22479,23575,24818,26059,27374);

		 Averaged = NDoses(39,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,877,1530,2182,2834,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);

		 Likelihood (Averaged_out, LogNormal_v, Prediction(Averaged_out),  sigmasq_AM);

		 Simulation { 
						 n0 =  0.8 ;
             nsol =  0.55 ;
             z0 =  0.5 ;
             zmax =  10 ;
             ro =  0.00265 ;
             lrn = 5.9344800000000001e-05 ;
             Dt = 1 ;
             Kdd = 68000 ;	
             d = 1 ;	
             Q = 2500 ;	
             SS = 30 ;
             d50 = 35 ;
             nsed = 0.8 ;
             nDepot = 49 ;
             nRelease = 45 ;
             nOutput = 39 ;
             Nj = 27667 ;
             NjD = 17885 ;
             NjR = 23360 ;

				  Print(Averaged_out,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(Averaged_out,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);
				  Print(sigmasq_AM_prop,877,2182,3486,4217,4947,5678,6408,6992,7575,8158,8742,9267,9733,10201,10667,11133,11601,12067,12534,13001,13409,13759,14109,14459,14809,15705,16601,17497,18393,19289,20185,21081,21977,23022,24216,25411,27667);
				  Data(sigmasq_AM_prop,1.109201,1.73629,4.420123,28.73544,38.15568,99.47335,208.3335,178.1828,117.6312,79.42852,58.00321,54.1511,48.45839,44.2811,42.9929,44.93082,40.52784,35.24999,44.30616,51.00247,43.17532,36.82834,33.62038,39.22608,136.7602,52.10019,33.2299,25.77814,22.16008,16.78586,14.38933,12.36043,12.11735,11.06874,11.02335,10.22104,8.416843);

		 }
}

 End.
```
